"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6638],{6638:function(n,e,t){t.d(e,{Z:function(){return Fn}});var r,i,o,l,a=t(85893),u=t(96348),s=t(74961),c=t(20208),f=t(81678),d=t(11163),p=t(67294);function g(){return g=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},g.apply(this,arguments)}var b=function(n){return p.createElement("svg",g({width:33,height:29,viewBox:"0 0 33 29",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n),r||(r=p.createElement("path",{d:"M11.714 21V3.95493C7.42842 1.22772 2.78567 0.870589 1 1.03292V18.565C6.45442 18.1754 10.4154 20.026 11.714 21Z",stroke:"white",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),i||(i=p.createElement("path",{d:"M12.2 21V3.95493C16.4856 1.22772 21.1284 0.870589 22.9141 1.03292V18.565C17.4596 18.1754 13.4987 20.026 12.2 21Z",stroke:"white",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),o||(o=p.createElement("circle",{cx:23,cy:19,r:10,fill:"#20232D"})),l||(l=p.createElement("path",{d:"M22.8971 12.8271V24.9651M16.8281 18.8961L28.966 18.8961",stroke:"#FF8746",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))},h=t(86896),y=t(45170),x=t(19521),v=t(83555),m=t(67899),w=t(15721),k=t(48990),L=t(26063),j=t(93921),S=t(40375),C=t(49027),P=t(69299),Z=t(47516);function O(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function N(){var n=O(["\n  display: flex;\n  position: relative;\n  align-items: center;\n  justify-content: center;\n  width: 48px;\n  height: 48px;\n\n  margin: 0px 10px;\n\n  border-radius: 40px;\n  background: ",";\n\n  cursor: pointer;\n"]);return N=function(){return n},n}function A(){var n=O([""]);return A=function(){return n},n}function E(){var n=O(["\n  top: 60px;\n  right: 15px;\n  position: absolute;\n  width: 200px;\n  height: 160px;\n  z-index: ",";\n\n  background: #15171e;\n  box-shadow: 0px 2px 20px rgba(0, 0, 0, 0.3);\n  border-radius: 10px;\n"]);return E=function(){return n},n}function M(){var n=O(["\n  display: flex;\n  align-items: center;\n  min-height: 32px;\n  padding: 0px 20px;\n\n  background: #15171e;\n\n  border-top-left-radius: 10px;\n  border-top-right-radius: 10px;\n\n  font-family: ",";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n\n  color: ",";\n"]);return M=function(){return n},n}function z(){var n=O(["\n  display: flex;\n  align-items: center;\n  height: 42px;\n  padding-left: 24px;\n\n  background: ",";\n\n  border-top: ",";\n\n  font-family: ",";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 16px;\n  line-height: 22px;\n\n  color: ",";\n\n  &:last-child {\n    border-bottom-left-radius: 10px;\n    border-bottom-right-radius: 10px;\n  }\n"]);return z=function(){return n},n}var F=x.ZP.div(N(),(function(n){var e=n.theme;return n.isClicked?e.colors.s4:e.colors.s5})),I=(0,x.ZP)(Z.bM7)(A()),R=x.ZP.div(E(),9999),T=x.ZP.div(M(),(function(n){return n.theme.wfont.NunitoSansRegular}),(function(n){return n.theme.colors.s3})),D=x.ZP.option(z(),(function(n){return n.selected?"#24262b":"#15171e"}),(function(n){var e=n.theme;return"1px solid ".concat(e.colors.s5)}),(function(n){return n.theme.wfont.NunitoSansRegular}),(function(n){return n.theme.colors.s1})),B=function(n){var e=n.filterBy,t=n.onChangeSort,r=(0,x.Fg)(),i=(0,p.useState)(!1),o=i[0],l=i[1],u=(0,p.useRef)(null),s=(0,c.D)().options;(0,P.Z)(u,(function(){l(!1)}));var f=(0,p.useCallback)((function(){l(!0)}),[]);return(0,a.jsxs)(F,{onClick:f,ref:u,isClicked:o,children:[(0,a.jsx)(I,{size:24,color:r.colors.s1}),o?(0,a.jsxs)(R,{children:[(0,a.jsx)(T,{children:"Sorted By"}),s.map((function(n){return(0,a.jsx)(D,{selected:Object.entries(e).some((function(e){return e[1]&&e[0]===n.id})),value:n.id,onClick:function(e){e.stopPropagation(),t(n.id),l(!1)},children:n.label},n.id)}))]}):null]})},q=t(5434);function V(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function _(){var n=V(["\n  position: relative;\n\n  margin: 0px 10px;\n\n  min-width: ","px;\n  height: ","px;\n\n  background: rgba(255, 135, 70, 0.12);\n  /* Accent/p1 */\n\n  border: ",";\n  border-radius: 100px;\n\n  font-family: ",";\n  font-style: normal;\n  font-weight: 600;\n  font-size: 16px;\n  line-height: 24px;\n\n  display: flex;\n  align-items: center;\n  text-align: center;\n  justify-content: center;\n\n  color: ",";\n\n  cursor: pointer;\n"]);return _=function(){return n},n}function H(){var n=V(["\n  top: 60px;\n  position: absolute;\n  width: 200px;\n  height: 100%;\n  z-index: ",";\n\n  background: #15171e;\n  box-shadow: 0px 2px 20px rgba(0, 0, 0, 0.3);\n  border-radius: 10px;\n"]);return H=function(){return n},n}function U(){var n=V(["\n  display: flex;\n  align-items: center;\n  min-height: 32px;\n  padding: 0px 20px;\n\n  background: #15171e;\n\n  border-top-left-radius: 10px;\n  border-top-right-radius: 10px;\n\n  font-family: ",";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n\n  /* Primary/s3_dark */\n\n  color: ",";\n"]);return U=function(){return n},n}function W(){var n=V(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 42px;\n\n  border-top: ",";\n\n  background: ",";\n\n  font-family: ",";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 16px;\n  line-height: 22px;\n\n  color: ",";\n\n  &:last-child {\n    border-bottom-left-radius: 10px;\n    border-bottom-right-radius: 10px;\n  }\n"]);return W=function(){return n},n}function Q(){var n=V([""]);return Q=function(){return n},n}var G=x.ZP.div(_(),(function(n){return n.width||166}),(function(n){return n.width||40}),(function(n){var e=n.theme;return" 1px solid ".concat(e.colors.p1)}),(function(n){return n.theme.wfont.NunitoSansRegular}),(function(n){return n.theme.colors.p1})),$=x.ZP.div(H(),9999),K=x.ZP.div(U(),(function(n){return n.theme.wfont.NunitoSansRegular}),(function(n){return n.theme.colors.s3})),Y=x.ZP.div(W(),(function(n){var e=n.theme;return"1px solid ".concat(e.colors.s5)}),(function(n){return n.isSelected?"#20232D":"#15171e"}),(function(n){return n.theme.wfont.NunitoSansRegular}),(function(n){return n.theme.colors.s1})),J=(0,x.ZP)(q.x3N)(Q()),X=function(n){var e=n.allCount,t=n.width,r=n.height,i=n.selectedLanguage,o=n.options,l=n.onChange,u=(0,h.Z)(),s=(0,p.useState)(!1),c=s[0],f=s[1],d=(0,p.useRef)(null),g=(0,p.useCallback)((function(){f(!0)}),[]);return(0,P.Z)(d,(function(){f(!1)})),(0,a.jsxs)(G,{className:"language-selector",ref:d,width:t,height:r,onClick:g,children:[i?u.formatDisplayName(i,{type:"language"}):u.formatMessage({id:"all-languages"}),(0,a.jsx)(J,{}),c?(0,a.jsxs)($,{children:[(0,a.jsx)(K,{children:u.formatMessage({id:"language"})}),(0,a.jsxs)(Y,{isSelected:null===i,onClick:function(n){n.stopPropagation(),l(null),f(!1)},children:["All(",e||0,")"]},-1),o.map((function(n){return(0,a.jsxs)(Y,{isSelected:i===n.type,onClick:function(e){e.stopPropagation(),n.type&&l(n.type),f(!1)},children:[u.formatDisplayName(n.label,{type:"language"}),"(",n.count,")"]},n.id)}))]}):null]})},nn=t(60606),en=t(75562),tn=t(59246),rn=t(19505);function on(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function ln(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function an(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})))),r.forEach((function(e){ln(n,e,t[e])}))}return n}function un(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function sn(n){return function(n){if(Array.isArray(n))return on(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(!n)return;if("string"===typeof n)return on(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return on(n,e)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cn(){var n=un(["\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  margin: 0 15px;\n"]);return cn=function(){return n},n}function fn(){var n=un(["\n  display: grid;\n  width: 100%;\n  grid-template-columns: repeat(2, 1fr);\n  grid-gap: 3px;\n"]);return fn=function(){return n},n}function dn(){var n=un(["\n  display: flex;\n  height: 100%;\n"]);return dn=function(){return n},n}function pn(){var n=un(["\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n"]);return pn=function(){return n},n}function gn(){var n=un(["\n  height: calc(100vh - 200px);\n  overflow-y: scroll;\n  overflow-x: hidden;\n\n  &::-webkit-scrollbar {\n    width: 5px;\n    padding-top: 2em;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    width: 3%;\n    background-color: ",";\n  }\n\n  @media (max-height: ","px) {\n    height: calc(100% - 200px);\n  }\n"]);return gn=function(){return n},n}function bn(){var n=un(["\n  display: flex;\n  flex-direction: row;\n\n  padding: 20px 0px;\n"]);return bn=function(){return n},n}function hn(){var n=un(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  flex: 1;\n"]);return hn=function(){return n},n}function yn(){var n=un(["\n  width: 100%;\n  font-family: ",";\n  font-size: 16px;\n  line-height: 25px;\n  color: ",";\n  text-align: center;\n"]);return yn=function(){return n},n}function xn(){var n=un(["\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n  padding: 18px 0px;\n"]);return xn=function(){return n},n}function vn(){var n=un(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  margin-left: auto;\n  align-items: center;\n  padding: 5px 20px;\n\n  width: 89px;\n  height: 34px;\n  color: ",";\n  background: ",";\n  border: ",";\n  box-sizing: border-box;\n  border-radius: 100px;\n\n  font-family: ",";\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  line-height: 19px;\n\n  &:hover {\n    cursor: pointer;\n    opacity: 0.8;\n  }\n"]);return vn=function(){return n},n}function mn(){var n=un(["\n  width: 240px;\n  color: ",";\n\n  font-family: ",";\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  line-height: 19px;\n"]);return mn=function(){return n},n}var wn="SCROLL_HEIGHT",kn=function(n,e){return!0===n.alphabet?e=e.sort((function(n,e){return n.title<e.title?1:-1})):!0===n.date?e=e.sort((function(n,e){return n.createdAt<e.createdAt?1:-1})):!0===n.view?e=e.sort((function(n,e){return n.views<e.views?1:-1})):!0===n.oldest&&(e=e.sort((function(n,e){return n.createdAt>e.createdAt?1:-1}))),e},Ln=function(n,e){return n.alphabet?e=e.sort((function(n,e){if(n.library&&e.library){if(n.library.title<e.library.title)return 1;if(n.library.title>e.library.title)return-1}return 0})):n.date?e=e.sort((function(n,e){if(n.library&&e.library){if(n.library.createdAt<e.library.createdAt)return 1;if(n.library.createdAt>e.library.createdAt)return-1}return 0})):n.view?e=e.sort((function(n,e){if(n.library&&e.library){if(n.library.views<e.library.views)return 1;if(n.library.views>e.library.views)return-1}return 0})):n.oldest&&(e=e.sort((function(n,e){if(n.library&&e.library){if(n.library.createdAt>e.library.createdAt)return 1;if(n.library.createdAt<e.library.createdAt)return-1}return 0}))),e.sort((function(n,e){return(e.library.pinned?new Date(e.library.pinned).getTime():0)-(n.library.pinned?new Date(n.library.pinned).getTime():0)}))},jn=x.ZP.div(cn()),Sn=x.ZP.div(fn()),Cn=x.ZP.div(dn()),Pn=x.ZP.div(pn()),Zn=x.ZP.div(gn(),(function(n){return n.theme.colors.s4}),680),On=x.ZP.div(bn()),Nn=x.ZP.div(hn()),An=x.ZP.h2(yn(),(function(n){return n.theme.wfont.NotoSansKR}),(function(n){return n.theme.colors.s1})),En=x.ZP.div(xn()),Mn=x.ZP.button(vn(),(function(n){return n.theme.colors.s1}),(function(n){return n.theme.colors.p1}),(function(n){var e=n.theme;return"1px solid ".concat(e.colors.p1)}),(function(n){return n.theme.wfont.NunitoSansRegular})),zn=x.ZP.span(mn(),(function(n){return n.theme.colors.s1}),(function(n){return n.theme.wfont.NunitoSansRegular})),Fn=function(n){var e=n.isExplore,t=n.myLibrary,r=n.notebookOpenForInCall,i=(0,h.Z)(),o=(0,u.k2)(),l=(0,u.cn)(o),g=(0,x.Fg)(),P=(0,d.useRouter)(),Z=(0,p.useState)(),O=Z[0],N=Z[1],A=(0,c.Z)(t),E=A.searchFilter,M=A.onChangeLanguageFilter,z=A.onChangeLevelFilter,F=A.onChangeSortFilter,I=(0,p.useState)([]),R=I[0],T=I[1],D=(0,f.aV)().data,q=(0,p.useState)([]),V=q[0],_=q[1],H=s.utils.useUserProfile.useUserProfile(o?(0,u.RY)(o):null).data,U=(0,en.O)((function(n){return n.librarySearch})).lastSearchValue,W=(0,en.W)(tn.h).setLastSearchValue,Q=(0,p.useState)(""),G=Q[0],$=Q[1],K=(0,p.useState)(!1),Y=K[0],J=K[1],on=(0,f.ZP)().data,ln=(0,f._A)(),un=ln.onCreate,cn=ln.onDelete,fn=ln.onUpdate,dn=(0,f.O$)(),pn=dn.onUnsubscribe,gn=dn.onSubscribe,bn=(0,p.useState)(!1),hn=bn[0],yn=bn[1],xn=(0,p.useState)(rn.x2),vn=xn[0],mn=xn[1],Fn=(0,p.useState)(!1),In=Fn[0],Rn=Fn[1],Tn=(0,p.useState)({top:0,left:0,library:null,open:!1}),Dn=Tn[0],Bn=Tn[1],qn=(0,f.A2)(E.filter),Vn=qn.data,_n=qn.refetch,Hn=(0,f.fD)(E,l),Un=Hn.data,Wn=Hn.fetchNextPage,Qn=Hn.isFetching,Gn=Hn.refetch,$n=s.utils.cafe.useIsCafeManagerOrHost().data,Kn=s.utils.debounce.default(G,200),Yn=(0,p.useMemo)((function(){var n=[];if(Y&&G.length>0){var e=R.filter((function(n){return"undefined"!==typeof n.targetLang&&"undefined"!==typeof n.targetLevel})).map((function(n){return{targetLang:n.targetLang,targetLevel:n.targetLevel}}));n=(0,nn.qR)(e)}else t&&Vn?n=(0,nn.qR)(Vn.filter((function(n){return"undefined"!==typeof n.targetLang&&"undefined"!==typeof n.targetLevel})).map((function(n){return{targetLang:n.targetLang,targetLevel:n.targetLevel}}))):D&&(n=(0,nn.qR)(D));return n}),[D,Vn,t,Y,G,R]),Jn=(0,p.useMemo)((function(){return Y?null:(0,a.jsxs)(En,{className:"library-explore-wrapper",children:[(0,a.jsx)(zn,{className:"library-explore-text",children:i.formatMessage({id:"explore-notebook-description"})}),(0,a.jsx)(Mn,{className:"library-explore-button",onClick:function(){P.push("/notebooks")},children:i.formatMessage({id:"explore"})})]})}),[i,Y,P]),Xn=(0,p.useMemo)((function(){if(null!=V&&(E.lang.length>0||E.level.length>0)){var n=[];return E.level.length>0&&(n=V.filter((function(n){if(null!=n.library&&null!=n.library.targetLevel)return E.level.includes(n.library.targetLevel)}))),E.lang.length>0&&n.length>0?n=n.filter((function(n){var e,t;return(null===(e=n.library)||void 0===e?void 0:e.targetLang)&&E.lang.includes(null===(t=n.library)||void 0===t?void 0:t.targetLang)})):E.lang.length>0&&0===n.length&&(n=V.filter((function(n){var e,t;return(null===(e=n.library)||void 0===e?void 0:e.targetLang)&&E.lang.includes(null===(t=n.library)||void 0===t?void 0:t.targetLang)}))),n}return null!=V?V:[]}),[V,E.lang,E.level]),ne=(0,p.useMemo)((function(){return null!=on&&on.length>0?{content:on.find((function(n){return null!=n.imageUrl}))||null,count:on.length}:{content:null,count:0}}),[on]),ee=(0,p.useMemo)((function(){var n=[];if(Y&&G.length>0){var e=R.filter((function(n){return"undefined"!==typeof n.targetLang&&"undefined"!==typeof n.targetLevel})).map((function(n){return{targetLang:n.targetLang,targetLevel:n.targetLevel}}));n=(0,nn.nw)(e)}else D&&(n=(0,nn.nw)(D));return n}),[D,Y,G,R]),te=(0,p.useCallback)((function(){yn(!1),mn(rn.x2)}),[]),re=(0,p.useCallback)((function(n){r&&(n.library?r(n.library.id):r(null))}),[r]),ie=(0,p.useCallback)((function(n,e,t){Bn({library:n,open:!0,top:e,left:t})}),[]),oe=(0,p.useCallback)((function(n){$(n)}),[]),le=(0,p.useCallback)((function(){vn&&!In&&vn.title.length<=rn.No&&vn.id&&fn(vn.id,vn).then((function(){Rn(!1),mn(rn.x2),te(),_n()}))}),[In,_n,vn,fn,te]),ae=(0,p.useCallback)((function(){vn&&!In&&vn.title.length<=rn.No&&un(vn).then((function(n){Rn(!1),te(),P.push({pathname:"lessons/".concat(n.slug),query:an({},P.query,{isFromMyLibrary:!!t})},"/lessons/".concat(n.slug)),_n()}))}),[In,un,te,P,t,_n,vn]),ue=(0,p.useCallback)((function(){vn.id?le():ae(),Rn(!0)}),[vn,le,ae]),se=(0,p.useCallback)((function(n){yn(!0),mn({id:n.id,targetLang:n.targetLang||"",targetLevel:n.targetLevel,title:n.title,visibility:n.visibility,interests:n.interests||[],types:n.types||[]})}),[]),ce=(0,p.useCallback)((function(n){null!==n&&pn(n)}),[pn]),fe=(0,p.useCallback)((function(n){null!=n&&gn(n)}),[gn]),de=(0,p.useCallback)((function(n){var e=n.target;e.scrollHeight>window.outerHeight&&window.sessionStorage.setItem(wn,String(e.scrollTop)),e.clientHeight+e.scrollTop!==e.scrollHeight||t||0!==(null===Kn||void 0===Kn?void 0:Kn.length)||Wn()}),[Kn,Wn,t]);(0,p.useEffect)((function(){if(Un&&!t&&0===(null===Kn||void 0===Kn?void 0:Kn.length)){var n=Un.pages.map((function(n){return n.result})).flat().map((function(n){return{library:n,privateNotebook:null}}));_(n)}}),[Y,Kn,t,Un]),(0,p.useEffect)((function(){if(Kn&&Y&&Kn.length>0){var n=Kn.trim();n.length>0&&(W(n),t?o&&(0,y.getLibraryBySearch)(o,n).then((function(e){(0,y.postAnalyticsSearchQuery)(o,{query:n,type:"library"}),T(kn(E.filter,e))})):(0,y.getAllLibraryBySearch)(o,n).then((function(e){o&&(0,y.postAnalyticsSearchQuery)(o,{query:n,type:"library-explore"}),T(kn(E.filter,e))})))}}),[o,Kn,t,W,Y,E.filter,Un]),(0,p.useEffect)((function(){U&&($(U),J(!0))}),[U]),(0,p.useEffect)((function(){Y||T([])}),[Y]),(0,p.useEffect)((function(){var n=[];Y&&Kn&&Kn.length>0&&(n=R.map((function(n){return{library:n,privateNotebook:null}})),E.lessons.length>0&&(n=n.filter((function(n){return!(!n.library||"undefined"===typeof n.library.types)&&E.lessons.some((function(e){return!!n.library.types&&n.library.types.some((function(n){return n===e}))}))}))),E.interests.length>0&&(n=n.filter((function(n){return!(!n.library||"undefined"===typeof n.library.interests)&&E.interests.some((function(e){return!!n.library.interests&&n.library.interests.some((function(n){return n===e}))}))}))),E.lang[0]&&(n=n.filter((function(n){return n.library.targetLang===E.lang[0]}))),E.level.length>0&&(n=n.filter((function(n){return"undefined"!==typeof n.library.targetLevel&&E.level.includes(n.library.targetLevel)}))),_(n))}),[t,Y,Kn,R,E,Un]),(0,p.useEffect)((function(){P.query.id&&r&&(r(parseInt(P.query.id,10)),P.replace("/notebooks",void 0,{shallow:!0}))}),[P,r]),(0,p.useEffect)((function(){var n=window.sessionStorage.getItem(wn);O&&n&&O.scrollTo({top:parseInt(n,10),behavior:"auto"})}),[V,O]),(0,p.useEffect)((function(){var n=function(n){n.preventDefault(),window.sessionStorage.removeItem(wn)};return window.addEventListener("beforeunload",n),function(){window.removeEventListener("beforeunload",n)}}),[]),s.utils.performance.useStableIdentity("LibraryList.data",V);var pe=(0,p.useCallback)((function(){J(!1),$(""),W("")}),[W]);return(0,p.useEffect)((function(){var n=[],e=ne||null;t&&!Y&&(n=Vn?Vn.map((function(n){return{library:n,privateNotebook:null}})):[],E.lessons.length>0&&(n=n.filter((function(n){return!(!n.library||"undefined"===typeof n.library.types)&&E.lessons.some((function(e){return!(!n.library||!n.library.types)&&n.library.types.some((function(n){return n===e}))}))}))),E.interests.length>0&&(n=n.filter((function(n){return!(!n.library||"undefined"===typeof n.library.interests)&&E.interests.some((function(e){return!(!n.library||!n.library.interests)&&n.library.interests.some((function(n){return n===e}))}))}))),E.lang[0]&&(n=n.filter((function(n){return n.library?n.library.targetLang===E.lang[0]:[]}))),E.level.length>0&&(n=n.filter((function(n){return!(!n.library||"undefined"===typeof n.library.targetLevel)&&E.level.includes(n.library.targetLevel)}))),(n=Ln(E.filter,n)).unshift({library:null,privateNotebook:e}),_(n))}),[E.filter,Vn,ne,Y,E,t]),t&&null===o?(0,a.jsx)(m.Z,{errorType:m.Q.NO_LOGIN}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(jn,{children:[(0,a.jsx)(S.Z,{titleSize:22,title:e?i.formatMessage({id:"explore"}):i.formatMessage({id:"library"}),customPadding:8,rightComponent:(H&&"verified"===H.verifiedTeacher||(null===H||void 0===H?void 0:H.trainer)||$n)&&(0,a.jsx)(b,{onClick:function(){yn(!0)}}),onClose:function(){e?P.push("/my-library"):P.push("/lobby")}}),(0,a.jsxs)(Pn,{children:[(0,a.jsxs)(Nn,{children:[(0,a.jsx)(C.B,{style:{width:370},isCenter:!1,className:"search-notebook-bar",placeholder:i.formatMessage({id:"search-notebook-placeholder"}),onChangeText:oe,value:G,onFocus:function(){J(!0)},backgroundColor:g.colors.s5,isSearchBarFocus:Y,onBack:pe}),(0,a.jsx)(B,{filterBy:E.filter,onChangeSort:F})]}),e&&(0,a.jsxs)(On,{children:[(0,a.jsx)(X,{selectedLanguage:0===E.lang.length?null:E.lang[0],onChange:M,allCount:D?D.length:0,options:Yn}),(0,a.jsx)(nn.ZP,{onChangeFilter:z,filters:ee})]}),!e&&Jn,e||null!==o?Xn?(0,a.jsx)(Zn,{onScroll:de,ref:function(n){return N(n)},children:(0,a.jsxs)(Sn,{children:[V.map((function(n,t){return null===o?n.library&&(0,a.jsx)(k.b,{onClick:function(){re(n)},isFromLesson:!1,library:n.library},n.library.id):H?(0,a.jsx)(L.Z,{isExplore:e,user:H,isShowMenu:!0,library:n.library,onClick:function(){re(n)},onShowLibraryMenuSheet:ie,privateNotebook:n.privateNotebook},t):null})),Qn?sn(Array(50)).map((function(n,e){return(0,a.jsx)(j.Z,{},e)})):null]})}):(0,a.jsx)(Cn,{}):(0,a.jsx)(An,{children:i.formatMessage({id:"you-can-use-after-login"})})]})]}),H&&(0,a.jsx)(v.Z,{visible:hn,user:H,onClose:te,showCreateLibraryModal:hn,editLibrary:vn,onChangeText:function(n){return mn((function(e){return an({},e,{title:n})}))},isWaiting:In,onChangeInterests:function(n){return mn((function(e){return an({},e,{interests:n})}))},onChangeTypes:function(n){return mn((function(e){return an({},e,{types:n})}))},onSetPrivate:function(n){return mn((function(e){return an({},e,{visibility:n?"private":"public"})}))},onSetTargetLanguage:function(n){return mn((function(e){return an({},e,{targetLang:n})}))},onSetTargetLevel:function(n){return mn((function(e){return an({},e,{targetLevel:n})}))},onPressButton:ue}),Dn.open&&H&&Dn.library&&(0,a.jsx)(w.Z,{top:Dn.top,left:Dn.left,onClose:function(){Bn({top:0,left:0,library:null,open:!1})},isMine:H.id===Dn.library.creatorId,isExplore:!t,onDelete:cn,onSetEditLibrary:se,item:Dn,onUnsubscribe:function(){Dn.library&&(ce(Dn.library.id),Bn({top:0,left:0,library:null,open:!1}))},onSubscribe:function(){Dn.library&&(fe(Dn.library.id),Bn({top:0,left:0,library:null,open:!1}))},isAdmin:l,refetchInfiniteLibrary:Gn})]})}}}]);